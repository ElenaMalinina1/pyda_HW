{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"RNN 2","provenance":[],"collapsed_sections":[],"toc_visible":true,"authorship_tag":"ABX9TyM9tKm5/KQh+Vv9Bbh54zbn"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"e70c93a2761443b4afecf88136acdf71":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d0ef6f6fc79c4282bf6ea2cb0166fe14","IPY_MODEL_c9f9048ee02c4c1dbd3a98585af06fd6","IPY_MODEL_d0e41c6e8032414da7220af2310f49f1"],"layout":"IPY_MODEL_555e364b8b5f495f9937835bfdc2205c"}},"d0ef6f6fc79c4282bf6ea2cb0166fe14":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_56b68847813e43a2953181c220090cad","placeholder":"​","style":"IPY_MODEL_8ed030ce64af40b49428a8d28a3a22ca","value":"100%"}},"c9f9048ee02c4c1dbd3a98585af06fd6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_66416c0fdd9241089e14a8e1c1d1d109","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8852b970b60941e1a8789159c2b8f02e","value":378}},"d0e41c6e8032414da7220af2310f49f1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_27fa78840aeb44c3890a00a52922a2ea","placeholder":"​","style":"IPY_MODEL_b77335d470aa4b2f90143568c946c3be","value":" 378/378 [00:05&lt;00:00, 71.67it/s]"}},"555e364b8b5f495f9937835bfdc2205c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"56b68847813e43a2953181c220090cad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8ed030ce64af40b49428a8d28a3a22ca":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"66416c0fdd9241089e14a8e1c1d1d109":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8852b970b60941e1a8789159c2b8f02e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"27fa78840aeb44c3890a00a52922a2ea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b77335d470aa4b2f90143568c946c3be":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cdb23ecdcec7418daf90970f3189c1fb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bf7c7a17d6254b27b2bf79366195ab9a","IPY_MODEL_0eea9d7f300d420eae59f3616a01fb60","IPY_MODEL_21cb1ccf6b4549519d7b19597d4bb0ae"],"layout":"IPY_MODEL_68816a6c036745f995d75947a355f276"}},"bf7c7a17d6254b27b2bf79366195ab9a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_273d0db237c54d679c85121c5f68a0b6","placeholder":"​","style":"IPY_MODEL_0054259204ca4c8db0b5daaf2c380110","value":"100%"}},"0eea9d7f300d420eae59f3616a01fb60":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5b606424405b484da664a3343e108ec7","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_04630ff23c944ea782a001fb7231b327","value":378}},"21cb1ccf6b4549519d7b19597d4bb0ae":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_65b150d908fd4637ac000dd30b4383db","placeholder":"​","style":"IPY_MODEL_b730823ec8064890be2a10d48fd2c812","value":" 378/378 [00:05&lt;00:00, 75.90it/s]"}},"68816a6c036745f995d75947a355f276":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"273d0db237c54d679c85121c5f68a0b6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0054259204ca4c8db0b5daaf2c380110":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5b606424405b484da664a3343e108ec7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"04630ff23c944ea782a001fb7231b327":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"65b150d908fd4637ac000dd30b4383db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b730823ec8064890be2a10d48fd2c812":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b9bc1a413ac6432fb89a6af63ecf7569":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_162943f7c5324d54b81d9330c7ceec6c","IPY_MODEL_2f889c89dd1f4762bb7bf2ba12a8ac42","IPY_MODEL_9d31cc084b0b4d5a91ff839cf50e16fd"],"layout":"IPY_MODEL_6c9881cd4c9548ddb9945bd25df4ed2e"}},"162943f7c5324d54b81d9330c7ceec6c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2e51908826514b2f906b6c2d899911fb","placeholder":"​","style":"IPY_MODEL_de32ee9a11ab478fb3b04126a8b13628","value":"100%"}},"2f889c89dd1f4762bb7bf2ba12a8ac42":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1ed40818afbd4754a02d47af65e2c252","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f70ebc15287542699bf24b95e1195579","value":378}},"9d31cc084b0b4d5a91ff839cf50e16fd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_75fdc8e6794b489fb0007377290f69ec","placeholder":"​","style":"IPY_MODEL_eb3b7512f14f491597a5e4a294bbcbc8","value":" 378/378 [00:04&lt;00:00, 76.32it/s]"}},"6c9881cd4c9548ddb9945bd25df4ed2e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2e51908826514b2f906b6c2d899911fb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"de32ee9a11ab478fb3b04126a8b13628":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1ed40818afbd4754a02d47af65e2c252":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f70ebc15287542699bf24b95e1195579":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"75fdc8e6794b489fb0007377290f69ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eb3b7512f14f491597a5e4a294bbcbc8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a9fb09faf3534fb98690a092c8fe3ca5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4ce1862b17714c3181fd6cc8602f96d9","IPY_MODEL_2179c136005746fab2dc366c42cb7c47","IPY_MODEL_12c0fe12af594d6e93167475d40c8c09"],"layout":"IPY_MODEL_0ce1b2a9f7f6404682f24d2c285cdfbb"}},"4ce1862b17714c3181fd6cc8602f96d9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b9eee422a8e84236a4895bbe55510e97","placeholder":"​","style":"IPY_MODEL_df7b37cd8921490085f21cbba0d5d38e","value":"100%"}},"2179c136005746fab2dc366c42cb7c47":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1512b55228b34eb5a33f1c419d2bcbdf","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3651548b9c6a46ccaaf929b12faabb01","value":378}},"12c0fe12af594d6e93167475d40c8c09":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bb56177b00b64b339af040078e8f3cfb","placeholder":"​","style":"IPY_MODEL_5841717ecfe148f39d4a7c151ba4aac4","value":" 378/378 [00:05&lt;00:00, 75.68it/s]"}},"0ce1b2a9f7f6404682f24d2c285cdfbb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b9eee422a8e84236a4895bbe55510e97":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"df7b37cd8921490085f21cbba0d5d38e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1512b55228b34eb5a33f1c419d2bcbdf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3651548b9c6a46ccaaf929b12faabb01":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bb56177b00b64b339af040078e8f3cfb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5841717ecfe148f39d4a7c151ba4aac4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6387401ad6b8403490783ad7a59065bb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_957989c59390428b982cddd3e868656e","IPY_MODEL_618e88156ae942d3b460cc15fd2e0347","IPY_MODEL_06f410d02d7d4616aa3019d45d5f557a"],"layout":"IPY_MODEL_1b0ab8d2adb4409b9b6bdc4de2d6f55b"}},"957989c59390428b982cddd3e868656e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a8785cb103d44c06acd37fd6535fae20","placeholder":"​","style":"IPY_MODEL_18d70ac6b4714141be0784e566e168e2","value":"100%"}},"618e88156ae942d3b460cc15fd2e0347":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae60b2ffc4a04bbba356206d70cc13e4","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_db3f4809a3db4f2787e4b891a9242cdc","value":378}},"06f410d02d7d4616aa3019d45d5f557a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_93460901aac544bd81883022dbbb9e2a","placeholder":"​","style":"IPY_MODEL_8771803b260b432893d738bd5ef7006b","value":" 378/378 [00:05&lt;00:00, 76.12it/s]"}},"1b0ab8d2adb4409b9b6bdc4de2d6f55b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a8785cb103d44c06acd37fd6535fae20":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18d70ac6b4714141be0784e566e168e2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ae60b2ffc4a04bbba356206d70cc13e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db3f4809a3db4f2787e4b891a9242cdc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"93460901aac544bd81883022dbbb9e2a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8771803b260b432893d738bd5ef7006b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"818ace5c66fd4b00bee9342df790bde2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2dbe52ddb8494115a5301e0bc52bf513","IPY_MODEL_3ab507736b5c4fe6b25043e98e28a57b","IPY_MODEL_ebffa306e0f1416982849a0338f2b5e1"],"layout":"IPY_MODEL_11767cce5e9f402ab0b71f406a8e7d62"}},"2dbe52ddb8494115a5301e0bc52bf513":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7a341e28674e448282fada8e77b3bdea","placeholder":"​","style":"IPY_MODEL_4f175250b7404b35b0f90ba81a900603","value":"100%"}},"3ab507736b5c4fe6b25043e98e28a57b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9d8cd2985c484aa99ce5dbeafe322e4d","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cbfc63b168304f22a295f9e086434f59","value":378}},"ebffa306e0f1416982849a0338f2b5e1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9b171678b09b4340bb2b25fc6d1e77e1","placeholder":"​","style":"IPY_MODEL_3ea0313b340043fca1b0d16c62e18df3","value":" 378/378 [00:05&lt;00:00, 76.52it/s]"}},"11767cce5e9f402ab0b71f406a8e7d62":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7a341e28674e448282fada8e77b3bdea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f175250b7404b35b0f90ba81a900603":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9d8cd2985c484aa99ce5dbeafe322e4d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cbfc63b168304f22a295f9e086434f59":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9b171678b09b4340bb2b25fc6d1e77e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3ea0313b340043fca1b0d16c62e18df3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"29090ea02ed84f1c88eda3575f0712c1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8a81699ca4464c8887178363ce0b5ebb","IPY_MODEL_d44752446b4f46259abc48332fa17506","IPY_MODEL_26906669081f42ce99535a2a61edf5e3"],"layout":"IPY_MODEL_5814a34f213d48b2b18e96e5015d9ade"}},"8a81699ca4464c8887178363ce0b5ebb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6a284ee0dcd643068f9dc949200c1771","placeholder":"​","style":"IPY_MODEL_c288053062574cd58c62823f439884c6","value":"100%"}},"d44752446b4f46259abc48332fa17506":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b917463b6a7e49749e87e42d20f60fbe","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8cfa3ed0fc7f4c48897433d34bc6e6c0","value":378}},"26906669081f42ce99535a2a61edf5e3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6777ee0c732641e7972cbd2b5e16d7ec","placeholder":"​","style":"IPY_MODEL_a16df1351f56493fa4c789365ad26af8","value":" 378/378 [00:04&lt;00:00, 76.20it/s]"}},"5814a34f213d48b2b18e96e5015d9ade":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6a284ee0dcd643068f9dc949200c1771":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c288053062574cd58c62823f439884c6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b917463b6a7e49749e87e42d20f60fbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8cfa3ed0fc7f4c48897433d34bc6e6c0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6777ee0c732641e7972cbd2b5e16d7ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a16df1351f56493fa4c789365ad26af8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f16be14f7ad64c9c8c5f34749b20d0b6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6c8ff93be38548cb814f685e4ae27598","IPY_MODEL_685a22a99eec4eb192f05fe19896d4e4","IPY_MODEL_d7950e260a5240ad859b59a8e03a1268"],"layout":"IPY_MODEL_d53f6c6f2573474a80ff4dab04d8fc53"}},"6c8ff93be38548cb814f685e4ae27598":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae26e906d8c844168793dd6719900264","placeholder":"​","style":"IPY_MODEL_cdf06bfb39a940a1b6be344a842d2b3b","value":"100%"}},"685a22a99eec4eb192f05fe19896d4e4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e4f73212763647c7aedf14792496f87b","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_efe99c82d2644dc7ad2b8f22b23498fb","value":378}},"d7950e260a5240ad859b59a8e03a1268":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d35d3c1608e44aca9fc6f3ab2856aabe","placeholder":"​","style":"IPY_MODEL_14c4cc51d3b64a218143e336358c9681","value":" 378/378 [00:05&lt;00:00, 76.61it/s]"}},"d53f6c6f2573474a80ff4dab04d8fc53":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ae26e906d8c844168793dd6719900264":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cdf06bfb39a940a1b6be344a842d2b3b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e4f73212763647c7aedf14792496f87b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"efe99c82d2644dc7ad2b8f22b23498fb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d35d3c1608e44aca9fc6f3ab2856aabe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"14c4cc51d3b64a218143e336358c9681":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c5107095cf47423097c7a8e1ec299103":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8cd52338a78645cb94971b371a0baa01","IPY_MODEL_f4528c7fe54b4d69b7dca78e497d55f7","IPY_MODEL_27b283637c7c458f9ef0cf4f24c7a420"],"layout":"IPY_MODEL_2df7f34dfa4742e89f7da02ed43c47b4"}},"8cd52338a78645cb94971b371a0baa01":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4f1c61d66f9f48db8861318d8a406d4a","placeholder":"​","style":"IPY_MODEL_d804c649ebef4d6c8168aa0485c95a33","value":"100%"}},"f4528c7fe54b4d69b7dca78e497d55f7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8c1cdb76a7af425087354699db1ad3cd","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dc50e7c79df140309447de376e9e91b4","value":378}},"27b283637c7c458f9ef0cf4f24c7a420":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_335d891ca98b4c8a84d1bd0db1a7b8fb","placeholder":"​","style":"IPY_MODEL_10a7c325b25a47f191c1ec6e38698af3","value":" 378/378 [00:04&lt;00:00, 77.28it/s]"}},"2df7f34dfa4742e89f7da02ed43c47b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f1c61d66f9f48db8861318d8a406d4a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d804c649ebef4d6c8168aa0485c95a33":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8c1cdb76a7af425087354699db1ad3cd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc50e7c79df140309447de376e9e91b4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"335d891ca98b4c8a84d1bd0db1a7b8fb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10a7c325b25a47f191c1ec6e38698af3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"79eb653f24f543d7b4a5b81342a00a54":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_977a4e5653fc475c8b5cd17a601bbc70","IPY_MODEL_fec06ba1753241fea53c082c1195633e","IPY_MODEL_623ebfcfbcf54bda8dcd5fd9f4679212"],"layout":"IPY_MODEL_21b6289924b549d581cbda5f76346a4d"}},"977a4e5653fc475c8b5cd17a601bbc70":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_828c00c1c21b4ddbbbfb7c8c5f23f834","placeholder":"​","style":"IPY_MODEL_f0db30132094496388db6250628bc627","value":"100%"}},"fec06ba1753241fea53c082c1195633e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_df64023b99704c449f6e1dcf4d87afe2","max":378,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1bcae307aef6412da4536822cb1bd833","value":378}},"623ebfcfbcf54bda8dcd5fd9f4679212":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_aaf1a619993b4cffa43dd966555fd04f","placeholder":"​","style":"IPY_MODEL_e8d83cbb3a0049bb8e7411b7e5dd8582","value":" 378/378 [00:05&lt;00:00, 72.90it/s]"}},"21b6289924b549d581cbda5f76346a4d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"828c00c1c21b4ddbbbfb7c8c5f23f834":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f0db30132094496388db6250628bc627":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"df64023b99704c449f6e1dcf4d87afe2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1bcae307aef6412da4536822cb1bd833":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"aaf1a619993b4cffa43dd966555fd04f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e8d83cbb3a0049bb8e7411b7e5dd8582":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# Задание\n","Сгенерировать последовательности, которые бы состояли из цифр (от 0 до 9)\n","и задавались следующим образом:\n","\n","x - последовательность цифр\n","\n","y1 = x1, y(i) = x(i) + x(1). Если y(i) >= 10, то y(i) = y(i) - 10\n","\n","**Задача:**\n","\n","научить модель предсказывать y(i) по x(i)\n","\n","пробовать RNN, LSTM, GRU"],"metadata":{"id":"QJHJYyKlaYql"}},{"cell_type":"code","execution_count":1,"metadata":{"id":"6Td9WRNNaX_K","executionInfo":{"status":"ok","timestamp":1658825938730,"user_tz":-180,"elapsed":771,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"outputs":[],"source":["import torch\n","from torch import nn\n","import copy\n","import re\n","import random\n","import tqdm\n","import time"]},{"cell_type":"code","source":["dev = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n","if dev.type == 'cuda':\n","  print(dev.type)\n","else:\n","  print('cpu')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QM1aF2ODbEFT","executionInfo":{"status":"ok","timestamp":1658825939791,"user_tz":-180,"elapsed":6,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"e8698282-5613-41a1-c274-8cd298cb0a18"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["cuda\n"]}]},{"cell_type":"code","source":["def f(x):\n","  return (x + x[:,0:1]) % 10\n","\n","t = torch.tensor"],"metadata":{"id":"r-nC-qy8bECd","executionInfo":{"status":"ok","timestamp":1658825939791,"user_tz":-180,"elapsed":5,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["class RNN_Network(torch.nn.Module):\n","  def __init__(self, n_classes, embedding_size, hidden_size, n_layers, rnn_type):\n","    super().__init__()\n","    self.embd = torch.nn.Embedding(n_classes, embedding_size)\n","    self.rnn = rnn_type(embedding_size, hidden_size, n_layers, batch_first = True)\n","    self.linear = torch.nn.Linear(hidden_size, n_classes)\n","\n","  def forward(self, input):\n","    r = self.embd(input)\n","    r = self.rnn(r)[0]\n","    r = self.linear(r).squeeze()\n","    return r"],"metadata":{"id":"EvjUvvS6bD_v","executionInfo":{"status":"ok","timestamp":1658825939791,"user_tz":-180,"elapsed":5,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["n_iters = 100000\n","n_classes = 10\n","embedding_size = 10\n","hidden_size = 50\n","num_layers = 1\n","batch_size = 100\n","seq_len = 100\n","loss_best = 10 ** 10\n","rnn_list = [torch.nn.RNN, torch.nn.LSTM, torch.nn.GRU]\n","res = []\n","\n","for rnn_type in rnn_list:\n","    model = RNN_Network(n_classes, embedding_size, hidden_size, num_layers, rnn_type).to(dev)\n","    opt = torch.optim.Adam(model.parameters())\n","    crit = torch.nn.CrossEntropyLoss()\n","\n","    for iter in range(n_iters):\n","        model.train()\n","        x = torch.randint(n_classes, (batch_size, seq_len)).to(dev)\n","        y = f(x)\n","        opt.zero_grad()\n","        pred = model(x)\n","        score = (y == pred.argmax(dim=-1)).sum() / t(y.shape).prod()\n","        if score == 1:\n","            res.append(f'{rnn_type.__name__} finished on iter {iter}, loss = {loss}, score = {score}')\n","            print(f'\\n{res[-1]}\\n')\n","            break\n","        loss = crit(pred.reshape(-1, n_classes), y.flatten()).to(dev)  \n","        if loss < loss_best: \n","            model_best = copy.copy(model)\n","            loss_best = loss\n","        loss.backward()\n","        opt.step()\n","        if iter % (n_iters / 10) == 0:\n","            model.eval()\n","            x = torch.randint(n_classes, (batch_size, seq_len)).to(dev)\n","            y = f(x)\n","            pred = model(x).argmax(dim=-1)\n","            score = (y == pred).sum() / t(y.shape).prod()\n","            better_rand = score / n_classes * 100\n","            print(f'{rnn_type.__name__} iter {iter}, loss = {loss}, loss_best = {loss_best}, score = {score}, better_rand = {better_rand}')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rDiIyyJ1bD3h","executionInfo":{"status":"ok","timestamp":1658826151279,"user_tz":-180,"elapsed":211493,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"e0aea827-a22d-4573-a7c0-6293c456c6fc"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["RNN iter 0, loss = 2.3189377784729004, loss_best = 2.3189377784729004, score = 0.09649999439716339, better_rand = 0.9649999141693115\n","RNN iter 10000, loss = 0.688282310962677, loss_best = 0.6872541904449463, score = 0.5148999691009521, better_rand = 5.1489996910095215\n","RNN iter 20000, loss = 0.6315094828605652, loss_best = 0.5370277166366577, score = 0.5922999978065491, better_rand = 5.922999858856201\n","RNN iter 30000, loss = 0.25087565183639526, loss_best = 0.1693609058856964, score = 0.8226000070571899, better_rand = 8.226000785827637\n","RNN iter 40000, loss = 0.2234867364168167, loss_best = 0.06917097419500351, score = 0.8987999558448792, better_rand = 8.98799991607666\n","RNN iter 50000, loss = 0.10018031299114227, loss_best = 0.0479896254837513, score = 0.9158999919891357, better_rand = 9.159000396728516\n","\n","RNN finished on iter 50794, loss = 0.01949806697666645, score = 1.0\n","\n","LSTM iter 0, loss = 2.3111815452575684, loss_best = 0.01949806697666645, score = 0.09589999914169312, better_rand = 0.9589999914169312\n","\n","LSTM finished on iter 9165, loss = 0.05417453125119209, score = 1.0\n","\n","GRU iter 0, loss = 2.3160102367401123, loss_best = 0.014218579046428204, score = 0.10170000046491623, better_rand = 1.0170000791549683\n","\n","GRU finished on iter 1360, loss = 0.11375027894973755, score = 1.0\n","\n"]}]},{"cell_type":"code","source":["res"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nW8pwRcUbD0x","executionInfo":{"status":"ok","timestamp":1658826151279,"user_tz":-180,"elapsed":11,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"be877af8-de37-455d-dc45-dd733d89bda0"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['RNN finished on iter 50794, loss = 0.01949806697666645, score = 1.0',\n"," 'LSTM finished on iter 9165, loss = 0.05417453125119209, score = 1.0',\n"," 'GRU finished on iter 1360, loss = 0.11375027894973755, score = 1.0']"]},"metadata":{},"execution_count":6}]},{"cell_type":"markdown","source":["# Задание 2:\n","применить LSTM для решения лекционного практического задания"],"metadata":{"id":"J5JyvJmpbBLG"}},{"cell_type":"code","source":["!wget https://s3.amazonaws.com/text-datasets/nietzsche.txt"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eRWf3C35sRKg","executionInfo":{"status":"ok","timestamp":1658826153692,"user_tz":-180,"elapsed":2419,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"f8d51cbf-1105-4074-c49d-b52f1706b223"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stdout","text":["--2022-07-26 09:02:31--  https://s3.amazonaws.com/text-datasets/nietzsche.txt\n","Resolving s3.amazonaws.com (s3.amazonaws.com)... 52.216.113.165\n","Connecting to s3.amazonaws.com (s3.amazonaws.com)|52.216.113.165|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 600901 (587K) [text/plain]\n","Saving to: ‘nietzsche.txt.1’\n","\n","nietzsche.txt.1     100%[===================>] 586.82K   546KB/s    in 1.1s    \n","\n","2022-07-26 09:02:33 (546 KB/s) - ‘nietzsche.txt.1’ saved [600901/600901]\n","\n"]}]},{"cell_type":"code","source":["with open('nietzsche.txt', encoding='utf-8') as f:\n","    text = f.read().lower()\n","print('length:', len(text))\n","text = re.sub('[^a-z ]', ' ', text)\n","text = re.sub('\\s+', ' ', text)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fV941qddsRH5","executionInfo":{"status":"ok","timestamp":1658826153692,"user_tz":-180,"elapsed":9,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"12e2cb75-0bd3-419e-f346-1d2f20a13cc2"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["length: 600893\n"]}]},{"cell_type":"code","source":["text[:100]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"mZqxI7sesREv","executionInfo":{"status":"ok","timestamp":1658826153693,"user_tz":-180,"elapsed":9,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"7cfde0a0-3465-4439-f735-3fc1ea3e6aa5"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'preface supposing that truth is a woman what then is there not ground for suspecting that all philos'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["INDEX_TO_CHAR = sorted(list(set(text)))\n","CHAR_TO_INDEX = {c: i for i, c in enumerate(INDEX_TO_CHAR)}"],"metadata":{"id":"jDLFo7ODsRCI","executionInfo":{"status":"ok","timestamp":1658826153693,"user_tz":-180,"elapsed":8,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["MAX_LEN = 40\n","STEP = 3\n","SENTENCES = []\n","NEXT_CHARS = []\n","\n","for i in range(0, len(text) - MAX_LEN, STEP):\n","    SENTENCES.append(text[i: i + MAX_LEN])\n","    NEXT_CHARS.append(text[i + MAX_LEN])\n","print('Num sents:', len(SENTENCES))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"w5u9UqsksQ_d","executionInfo":{"status":"ok","timestamp":1658826153693,"user_tz":-180,"elapsed":7,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"e2c9c504-84ab-4ca2-dd1a-65e5d7316b03"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["Num sents: 193075\n"]}]},{"cell_type":"code","source":["print('Vectorization...')\n","X = torch.zeros((len(SENTENCES), MAX_LEN), dtype=int)\n","Y = torch.zeros((len(SENTENCES)), dtype=int)\n","for i, sentence in enumerate(SENTENCES):\n","    for t, char in enumerate(sentence):\n","        X[i, t] = CHAR_TO_INDEX[char]\n","    Y[i] = CHAR_TO_INDEX[NEXT_CHARS[i]]\n","print('Done')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3FudTLHCsQ4u","executionInfo":{"status":"ok","timestamp":1658826190141,"user_tz":-180,"elapsed":36454,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"4f4eac5e-3432-43ad-88e7-9ee69a3686de"},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["Vectorization...\n","Done\n"]}]},{"cell_type":"code","source":["BATCH_SIZE=512\n","dataset = torch.utils.data.TensorDataset(X, Y)\n","data = torch.utils.data.DataLoader(dataset, BATCH_SIZE, shuffle=True)"],"metadata":{"id":"GomlmeJ_sgqm","executionInfo":{"status":"ok","timestamp":1658826190142,"user_tz":-180,"elapsed":15,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["class NeuralNetwork(nn.Module):\n","    def __init__(self, rnnClass, dictionary_size, embedding_size, num_hiddens, num_classes):\n","        super().__init__()\n","        \n","        self.num_hiddens = num_hiddens\n","        self.embedding = nn.Embedding(dictionary_size, embedding_size)\n","        self.hidden = rnnClass(embedding_size, num_hiddens, batch_first=True)\n","        self.output = nn.Linear(num_hiddens, num_classes)\n","        \n","    def forward(self, X):\n","        out = self.embedding(X)\n","        _, state = self.hidden(out)\n","        predictions = self.output(state[0])\n","        return predictions.squeeze(0)"],"metadata":{"id":"zV_rqfP5sgoK","executionInfo":{"status":"ok","timestamp":1658826190142,"user_tz":-180,"elapsed":14,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["def sample(preds):\n","    softmaxed = torch.softmax(preds, 0)\n","    probas = torch.distributions.multinomial.Multinomial(1, softmaxed).sample()\n","    return probas.argmax()\n","\n","def generate_text():\n","    start_index = random.randint(0, len(text) - MAX_LEN - 1)\n","\n","    generated = ''\n","    sentence = text[start_index: start_index + MAX_LEN]\n","    generated += sentence\n","\n","    for i in range(MAX_LEN):\n","        x_pred = torch.zeros((1, MAX_LEN), dtype=int)\n","        for t, char in enumerate(generated[-MAX_LEN:]):\n","            x_pred[0, t] = CHAR_TO_INDEX[char]\n","\n","        preds = model(x_pred.cuda())[0].cpu()\n","        next_char = INDEX_TO_CHAR[sample(preds)]\n","        generated = generated + next_char\n","\n","    print(generated[:MAX_LEN] + '|' + generated[MAX_LEN:])"],"metadata":{"id":"koRSFKm0sglZ","executionInfo":{"status":"ok","timestamp":1658826190142,"user_tz":-180,"elapsed":14,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["model = NeuralNetwork(nn.LSTM, len(CHAR_TO_INDEX), 64, 128, len(CHAR_TO_INDEX)).to(dev)\n","criterion = torch.nn.CrossEntropyLoss()\n","optimizer = torch.optim.Adam(model.parameters())"],"metadata":{"id":"kC_yB9ZQsgc_","executionInfo":{"status":"ok","timestamp":1658826190143,"user_tz":-180,"elapsed":13,"user":{"displayName":"Vixen","userId":"12443801616054990678"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["for ep in range(10):\n","    start = time.time()\n","    train_loss = 0.\n","    train_passed = 0\n","\n","    model.train()\n","    for X_b, y_b in tqdm.tqdm_notebook(data):\n","        X_b, y_b = X_b.cuda(), y_b.cuda()\n","        optimizer.zero_grad()\n","        answers = model.forward(X_b)\n","        loss = criterion(answers, y_b)\n","        train_loss += loss.item()\n","\n","        loss.backward()\n","        optimizer.step()\n","        train_passed += 1\n","\n","    print(\"Epoch {}. Time: {:.3f}, Train loss: {:.3f}\".format(ep, time.time() - start, train_loss / train_passed))\n","    model.eval()\n","    generate_text()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":736,"referenced_widgets":["e70c93a2761443b4afecf88136acdf71","d0ef6f6fc79c4282bf6ea2cb0166fe14","c9f9048ee02c4c1dbd3a98585af06fd6","d0e41c6e8032414da7220af2310f49f1","555e364b8b5f495f9937835bfdc2205c","56b68847813e43a2953181c220090cad","8ed030ce64af40b49428a8d28a3a22ca","66416c0fdd9241089e14a8e1c1d1d109","8852b970b60941e1a8789159c2b8f02e","27fa78840aeb44c3890a00a52922a2ea","b77335d470aa4b2f90143568c946c3be","cdb23ecdcec7418daf90970f3189c1fb","bf7c7a17d6254b27b2bf79366195ab9a","0eea9d7f300d420eae59f3616a01fb60","21cb1ccf6b4549519d7b19597d4bb0ae","68816a6c036745f995d75947a355f276","273d0db237c54d679c85121c5f68a0b6","0054259204ca4c8db0b5daaf2c380110","5b606424405b484da664a3343e108ec7","04630ff23c944ea782a001fb7231b327","65b150d908fd4637ac000dd30b4383db","b730823ec8064890be2a10d48fd2c812","b9bc1a413ac6432fb89a6af63ecf7569","162943f7c5324d54b81d9330c7ceec6c","2f889c89dd1f4762bb7bf2ba12a8ac42","9d31cc084b0b4d5a91ff839cf50e16fd","6c9881cd4c9548ddb9945bd25df4ed2e","2e51908826514b2f906b6c2d899911fb","de32ee9a11ab478fb3b04126a8b13628","1ed40818afbd4754a02d47af65e2c252","f70ebc15287542699bf24b95e1195579","75fdc8e6794b489fb0007377290f69ec","eb3b7512f14f491597a5e4a294bbcbc8","a9fb09faf3534fb98690a092c8fe3ca5","4ce1862b17714c3181fd6cc8602f96d9","2179c136005746fab2dc366c42cb7c47","12c0fe12af594d6e93167475d40c8c09","0ce1b2a9f7f6404682f24d2c285cdfbb","b9eee422a8e84236a4895bbe55510e97","df7b37cd8921490085f21cbba0d5d38e","1512b55228b34eb5a33f1c419d2bcbdf","3651548b9c6a46ccaaf929b12faabb01","bb56177b00b64b339af040078e8f3cfb","5841717ecfe148f39d4a7c151ba4aac4","6387401ad6b8403490783ad7a59065bb","957989c59390428b982cddd3e868656e","618e88156ae942d3b460cc15fd2e0347","06f410d02d7d4616aa3019d45d5f557a","1b0ab8d2adb4409b9b6bdc4de2d6f55b","a8785cb103d44c06acd37fd6535fae20","18d70ac6b4714141be0784e566e168e2","ae60b2ffc4a04bbba356206d70cc13e4","db3f4809a3db4f2787e4b891a9242cdc","93460901aac544bd81883022dbbb9e2a","8771803b260b432893d738bd5ef7006b","818ace5c66fd4b00bee9342df790bde2","2dbe52ddb8494115a5301e0bc52bf513","3ab507736b5c4fe6b25043e98e28a57b","ebffa306e0f1416982849a0338f2b5e1","11767cce5e9f402ab0b71f406a8e7d62","7a341e28674e448282fada8e77b3bdea","4f175250b7404b35b0f90ba81a900603","9d8cd2985c484aa99ce5dbeafe322e4d","cbfc63b168304f22a295f9e086434f59","9b171678b09b4340bb2b25fc6d1e77e1","3ea0313b340043fca1b0d16c62e18df3","29090ea02ed84f1c88eda3575f0712c1","8a81699ca4464c8887178363ce0b5ebb","d44752446b4f46259abc48332fa17506","26906669081f42ce99535a2a61edf5e3","5814a34f213d48b2b18e96e5015d9ade","6a284ee0dcd643068f9dc949200c1771","c288053062574cd58c62823f439884c6","b917463b6a7e49749e87e42d20f60fbe","8cfa3ed0fc7f4c48897433d34bc6e6c0","6777ee0c732641e7972cbd2b5e16d7ec","a16df1351f56493fa4c789365ad26af8","f16be14f7ad64c9c8c5f34749b20d0b6","6c8ff93be38548cb814f685e4ae27598","685a22a99eec4eb192f05fe19896d4e4","d7950e260a5240ad859b59a8e03a1268","d53f6c6f2573474a80ff4dab04d8fc53","ae26e906d8c844168793dd6719900264","cdf06bfb39a940a1b6be344a842d2b3b","e4f73212763647c7aedf14792496f87b","efe99c82d2644dc7ad2b8f22b23498fb","d35d3c1608e44aca9fc6f3ab2856aabe","14c4cc51d3b64a218143e336358c9681","c5107095cf47423097c7a8e1ec299103","8cd52338a78645cb94971b371a0baa01","f4528c7fe54b4d69b7dca78e497d55f7","27b283637c7c458f9ef0cf4f24c7a420","2df7f34dfa4742e89f7da02ed43c47b4","4f1c61d66f9f48db8861318d8a406d4a","d804c649ebef4d6c8168aa0485c95a33","8c1cdb76a7af425087354699db1ad3cd","dc50e7c79df140309447de376e9e91b4","335d891ca98b4c8a84d1bd0db1a7b8fb","10a7c325b25a47f191c1ec6e38698af3","79eb653f24f543d7b4a5b81342a00a54","977a4e5653fc475c8b5cd17a601bbc70","fec06ba1753241fea53c082c1195633e","623ebfcfbcf54bda8dcd5fd9f4679212","21b6289924b549d581cbda5f76346a4d","828c00c1c21b4ddbbbfb7c8c5f23f834","f0db30132094496388db6250628bc627","df64023b99704c449f6e1dcf4d87afe2","1bcae307aef6412da4536822cb1bd833","aaf1a619993b4cffa43dd966555fd04f","e8d83cbb3a0049bb8e7411b7e5dd8582"]},"id":"XgEvM2cZtIHT","executionInfo":{"status":"ok","timestamp":1658826362034,"user_tz":-180,"elapsed":52174,"user":{"displayName":"Vixen","userId":"12443801616054990678"}},"outputId":"e277cdb5-e392-4663-e507-c3de1c658cd7"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:7: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  import sys\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e70c93a2761443b4afecf88136acdf71"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 0. Time: 5.606, Train loss: 1.205\n","ms the same spirit is embodied now large|r of knowledge to conception of this eve\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"cdb23ecdcec7418daf90970f3189c1fb"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 1. Time: 5.067, Train loss: 1.197\n","e must be connected with self denial who| we away in egreet of the old equality o\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b9bc1a413ac6432fb89a6af63ecf7569"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 2. Time: 4.989, Train loss: 1.191\n","ign of vigorous health that overplus whi|ch these freedden conceptionandly storib\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a9fb09faf3534fb98690a092c8fe3ca5"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 3. Time: 5.112, Train loss: 1.185\n","all and great expediencies and elaborati|on hitherto further the actions and gain\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6387401ad6b8403490783ad7a59065bb"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 4. Time: 5.108, Train loss: 1.179\n"," inexorable conscientiousness for the sa|id to antered wholly our free spiring ti\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"818ace5c66fd4b00bee9342df790bde2"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 5. Time: 5.104, Train loss: 1.172\n","children of wisdom must look upon fools |at live to the dreamed that is may out o\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"29090ea02ed84f1c88eda3575f0712c1"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 6. Time: 4.984, Train loss: 1.166\n"," evils living moving things flew out fro|m his element by populable also is exper\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f16be14f7ad64c9c8c5f34749b20d0b6"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 7. Time: 5.070, Train loss: 1.161\n","e basis even of everything sublime up to| the reponding and guides the nemalour l\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c5107095cf47423097c7a8e1ec299103"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 8. Time: 5.000, Train loss: 1.155\n","d to find still harder the person who kn|ow spirit two glail and creat strument l\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/378 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"79eb653f24f543d7b4a5b81342a00a54"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 9. Time: 5.145, Train loss: 1.150\n","red in the game woman s play is mediocre| he viest and act goes we vest will a pe\n"]}]}]}